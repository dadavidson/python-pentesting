#!/usr/bin/env python3

# Description: This script will find directories using a wordlist

import requests
import sys
import threading
import time

start_time = time.perf_counter()


def enum_dir(d):
    try:
        status = requests.get(d)
    except requests.ConnectionError:
        pass
    else:
        if status.status_code == 404:
            pass
        else:
            print("[+] Found: ", d)


domain = sys.argv[1]
wordlist = sys.argv[2]

importfile = open(wordlist).read()
dirlist = importfile.splitlines()

threads = []

for dir in dirlist:
    dirs = f"http://{domain}/{dir}.html"
    t = threading.Thread(target=enum_dir, args=[dirs])
    t.start()
    threads.append(t)

for thread in threads:
    thread.join()

end_time = time.perf_counter()
print(f"Finished in {round(end_time-start_time, 2)} second(s)")
