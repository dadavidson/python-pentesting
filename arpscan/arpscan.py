#!/usr/bin/env python3

# Description: This script will scan a network using ARP
#
# usage: python3 arpscan.py interface ipaddress/cidr
#
# example: python3 arpscan.py 10.10.10.10/24 eth0

import sys
from scapy.all import *

ip_range = sys.argv[1]
interface = sys.argv[2]
broadcastMac = "ff:ff:ff:ff:ff:ff"

packet = Ether(dst=broadcastMac)/ARP(pdst=ip_range)

ans, unans = srp(packet, timeout=2, iface=interface, inter=0.1)

for send, receive in ans:
    print(receive.sprintf(r"%Ether.src% - %ARP.psrc%"))
